# bscope
Analysis of Bilsufite-Seq data.

bscope is meant to convert BS-SNPer and Bismar .COV output files into files compatible with the methylkit and DSS R packages. Both of which are comminly used to identify DMCs and DMRs in methylomics studies. (see the BS_conversion() method)

bscope accepts CpG or CpH methylation files

bscope may output a graphical report on read coverage and methylation levels, see the Coverage_plot() and BS_report() functions respectively.

BScope is a Python3 module and requires Pandas, matplotlib, seaborn, numpy, scipy and sklearn



Usage
—————

##############################################

- First an object of the BsCope class is instantiated:

	bscope.BsCope(input_file_path, input_type, sample_name, experiment_name, context)

		.input_file_path:
			a list of methylation files and their path, for now bscope accepts only bismark.cov and bssnper output methylation files

		.input_type:
			a string indicating the type of files used as input: "bssnper" or "bismarkcov"

		.sample_name:
			a list of strings indicating the name of each sample, the sample name should be in the same order as the input_file_path list

		.experiment_name:
			a string indicating the name of the experiment

		.context:
			a string indicating the genomic context of the cytosines analyzed. It can be "CG" or "CH"


	Output: a BsCope python Object with attributes:
		self.path = input_file_path
		self.input_type = input_type
		self.name = sample_name
		self.experiment = experiment_name
		self.context = context
		self.input = a list of pandas DataFrames generated by the open_and_test_C_context() method.




###############################################

- Coverage_plot(self, output_path, output_file_name, coverage_lims = (1, 20))



###############################################
- the BS_conversion() method is used on the BSCope object to convert the file into the desired output (DSS or methyl kit compatible):
	
	BsCope Object.BS_trans(output_type,  output_file_path, min_coverage, report = True, header = False, compression = "gzip", line_terminator = « \n »)

		.output_type:
			the type of format for the output file: "DSS" or "methylkit".

		.output_file_path:
			the path to the directory where to store the output file.

		.report:
			whether to call the BS_view() function on the final dataframes and output a graphical report including methylation levels, pearson correlation and PCA analysis, default = True
		.min_coverage:
			filter cytosine to keep those with read coverage >= min_coverage
		.header = boolean
			Whether a header line should be added to the final file. False by default unless "DSS" output_type is chosen.

        .compression:
            compression of the final output file. Possible values are: None, "gzip", "zip", "bz2", "xz".

        .line_terminator:
            by defaults "/n". can be any character supported by the pandas to_csv() method.https://pandas.pydata.org/pandas-docs/stable/generated/				    pandas.DataFrame.to_csv.html

	Output: tsv files 



#################################################


-BS_view(input_, input_type, sample_name, context)

		
		input_:
			the output of BS_conversion() method stored in a variable (a list of pandas dataframes)
		input_type = « DSS » or « methylkit »
		sample_name = a list of sample names

Other functions


uniformDSS(samples_path, samples_names, output_path, compression = "gzip", index_col, sep = "\t")

		.samples_path:
			a list of path where to find the input files, designed to work on tsp files output of the BStrans() method. [/Path/to/sample/file.tsv, …].

		.samples_names:
			a list of samples names matching the files found in samples_path.

		.output_path:
			an absolute path where to store the output files.

		.compression:
			the compression status of the input, by default = « gzip », can be any compression supported by pandas read_csv() method.

		.index_col:
			the name of the column to use as index, if multindex (see pandas documentation)  provide a list of names. by default = ["chr", "pos »] as it corresponds to the format generated by the BS_trans() method and required for DSS
			
		.sep = « \t »:
			the delimiter in the inout file. The BS_trans() methods saves tsp files it is therefore default to « \t ».

